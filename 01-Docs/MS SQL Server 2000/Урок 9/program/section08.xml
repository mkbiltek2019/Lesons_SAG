<?xml version="1.0" encoding="windows-1251" ?>

<!DOCTYPE page [
<!ENTITY nbsp "&#160;">
<!ENTITY пробел "&#160;">
<!ENTITY shy "&#173;">
<!ENTITY перенос "&#173;">
]>

<?xml:stylesheet type="text/xsl" href="../common/layout.xsl" ?>

<Урок xmlns="x-schema:Schema.xml" название="Восстановление поврежденных системных баз данных."  предыдущий="section07.xml" следующий="section09.xml" copyright="© 2005 Вадим Волянский, Алексей Туманов.">

<h1 style="color:maroon">Восстановление поврежденных системных баз данных.</h1>

<p>Теперь вы можете быть спокойны за сохранность и восстанавливаемость баз данных. Однако еще один момент, который, к сожалению, может произойти - повреждение системных баз данных. В этом случае главное - не паниковать, а браться за работу.</p>

<h3 style="color:#05027E;text-align:center">Восстановление базы данных master.</h3>

<p>Для ее восстановления есть несколько вариантов.</p>

<p><b>Вариант ПЕРВЫЙ.</b></p>

<p>Если вы создавали резервную копию системных таблиц - это как раз то, что вам поможет. Причем, чем свежее резервная копия, тем меньше вам нужно будет восстанавливать. Итак, начнем.</p>

<ol>
<li>Нужно остановить службу SQL Server. Для этого может подойти либо визуальный интерфейс операционной системы, либо командная строка(cmd). Команда останавливающая службу SQL Server - 
<pre>

	<b>net stop mssqlserver</b>. 

</pre>
Эта команда останавливает стандартный экземпляр. Если же установлено несколько экземпляров, то нужно после этой команды указать $ и имя сервера, который необходимо остановить.<b>net stop mssqlserver$Имя_экзэмпляра</b>.</li>
<li>Запустить SQL Server как обычное приложение. Для этого в командной строке нужно набрать команду 
<pre>

<b>sqlservr.exe -m</b>

	Либо

<b>sqlservr.exe -m -Имя_экземпляра</b>
</pre>
</li>
<li>Восстановить базу данных из резервной копии.</li> 
<li>Запустить SQL Server как службу.
<pre>

<b>net start mssqlserver</b>

	Либо

<b>net start mssql$Имя_экземпляра</b>

</pre>
</li>
</ol>

<p><b>Вариант ВТОРОЙ.</b> Воспользоваться утилитой REBUILDM.EXE. Для этого</p>

<ol>

<li>Необходимо зайти в директорию C:\Program Files\Microsoft SQL Server\80\Tools\Binn и запустить утилиту rebuildm.exe.
</li>
</ol>
<img src="img\pict16.jpg"></img>


<p>Эта утилита позволяет скопировать и установить на сервер стандартную базу данных. Для этого нужно указать путь, нажав на кнопку Browse. К примеру, можно указать установочный диск SQL Server.</p> 
<p>После нажатия на кнопку Rebuild база данных master будет создана заново.</p>
<p>Если база данных master создана, то можно запускать сервер и производить восстановление стандартных баз данных, а после и пользовательских.</p>


</Урок>