<?xml version="1.0" encoding="windows-1251" ?>

<!DOCTYPE page [
<!ENTITY nbsp "&#160;">
<!ENTITY пробел "&#160;">
<!ENTITY shy "&#173;">
<!ENTITY перенос "&#173;">
]>

<?xml:stylesheet type="text/xsl" href="../common/layout.xsl" ?>

<Урок xmlns="x-schema:Schema.xml" название="Ключевые слова IN, BETWEEN, LIKE."  предыдущий="section04.xml" следующий="section07.xml" copyright="© 2005 Вадим Волянский, Алексей Туманов.">


<h2><font color="#800000">Ключевые слова IN, BETWEEN, LIKE.</font></h2>

<h3 align='center'><font color="#1925AB">Ключевое слово In.</font></h3>
<p>
Ключевое слово In используется для проверки на наличие чего либо в множестве. Что имеется в виду. Задача: "Показать все книги, которые издавались издательствами Питер, Блиц, Бином и Афон". Используя изученное до этого получим запрос:
</p>

<pre>
select name, izd<br/>
From books<br/>
Where Izd='Питер' or izd='Бином' or izd='Блиц' or izd='Афон'
</pre>

<p>
Новый вариант этого запроса выглядит следующим образом:
</p>

<pre>
select name, izd<br/>
From books<br/>
Where Izd in ('Питер', 'Бином', 'Блиц', 'Афон')
</pre>

<h3 align='center'><font color="#1925AB">Ключевое слово Between.</font></h3>
<p>
Between используется для проверки на принадлежность определенного значения указанному диапазону. Например, задача. Нужно показать все книги, у которых кол-во страниц больше 500, но меньше 650. Используя изученное до этого, получаем запрос.
</p>

<pre>
Select name,pages<br/>
From books<br/>
Where pages&gt;=500 and pages&lt;=650<br/>
order by 2 asc
</pre>

<p>
Новый вариант этого запроса:
</p>

<pre>
Select name,pages<br/>
From books<br/>
Where pages between 500 and 650<br/>
order by 2 asc
</pre>

<p>
Результат:
</p>

<img src="img/pict24.jpg"></img>

<p>
Также between можно использовать для работы с первой буквой строки. Но это будет проверка букв по ASCI кодам. Вот только при работе с цифрами верхний диапазон включается в диапазон проверки, а при работе с буквами - нет.
</p>

<pre>
Select name,pages<br/>
From books<br/>
Where name between 'г' and 'е'<br/>
order by 1 asc
</pre>

<img src="img/pict25.jpg"></img>

<h3 align='center'><font color="#1925AB">Ключевое слово Like.</font></h3>

<p>
Like позволяет производить поиск по шаблону. Шаблон представляет из себя строку, в которой используются служебные символы. Общий синтаксис:
</p>

<pre style="color=#FF0000">
Select имя_поля1, имя_поля2, имя_поля3<br/>
From имя_таблицы<br/>
Where имя_поля Like 'шаблон'
</pre>

<p>
В шаблоне можно указывать такие служебные символы и комбинации символов:
</p>

<ol>
	<li>% - заменяет любое кол-во любых символов в строке.</li>
	<li>_ - заменяет любой один символ.</li>
	<li>[набор символов] - определяет, что на этом месте может стоять один из перечисленных символов.</li>
	<li>[первый символ-второй символ] - определяет, что на этом месте может стоять один из символов в указанном диапазоне.</li>
	<li>[^набор символов] - определяет, что на этом месте может стоять любой, кроме перечисленных символов.</li>
	<li>[^первый символ-второй символ] - определяет, что на этом месте может стоять любой, кроме символов из указанного диапазона.</li>
</ol>

<p>
Пример1. Необходимо вычитать все книги, в названии которых есть слово Словарь.
</p>

<pre>
Select name,price<br/>
From books<br/>
Where name like '%словарь%'
</pre>

<p>
Пример2. Необходимо вычитать все названия книг, в названии которых первая буква либо А, либо З.
</p>

<pre>
Select name,price<br/>
From books<br/>
Where name like '[АЗ]%'
</pre>

<h3 align='center'><font color="#1925AB">Not.</font></h3>

<p>
Перед каждым из этих перечисленных ключевых слов можно указать ключевое слово Not, отрицающее то, что указано после него.
</p>

<p>
Пример. Показать все книги, цена у которых не находится в диапазоне от 25 до 150.
</p>

<pre>
Select name,price<br/>
From books<br/>
Where price not between 25 and 150<br/>
Order by 2 desc
</pre>

</Урок>