<?xml version="1.0" encoding="windows-1251" ?>

<!DOCTYPE page [
<!ENTITY nbsp "&#160;">
<!ENTITY пробел "&#160;">
<!ENTITY shy "&#173;">
<!ENTITY перенос "&#173;">
]>

<?xml:stylesheet type="text/xsl" href="../common/layout.xsl" ?>

<Урок xmlns="x-schema:Schema.xml" название="SQL Server"  предыдущий="index.xml" следующий="section02.xml" copyright="© 2005 Вадим Волянский, Алексей Туманов.">

<h1 style="color:maroon">Функции агрегирования.</h1>

<p>
До сих пор, все запросы, которые вы писали, отображали информацию, которая есть в базе данных каким либо образом. При этом максимально возможным было увеличить либо увеличить показываемое значение при показе, относительно начального. Функции агрегирования позволяют вычислить сумму, кол-во, среднее арифметическое и пр.
</p>

<p>
Вот их список:
</p>

<ol>
	<li>SUM(Имя_поля) - возвращает сумму значений в перечисленном столбце.</li>
	<li>COUNT(<b>[</b> [ALL | DISTINCT] Имя_поля <b>] </b>| <b>*</b>) - возвращает кол-во либо всех значений в запросе (ALL), либо всех, не учитывая повторяющиеся (DISTINCT), либо кол-во строк в результате запроса (при указании *).</li>
	<li>MAX(Имя_поля) - возвращает максимум из указанного поля.</li>
	<li>MIN(Имя_поля) - возвращает минимум из указанного поля.</li>
	<li>AVG(Имя_поля) - возвращает среднее арифметической из всех значений, которые есть в указанном поле.</li>
</ol>

<p>
Продолжаем работу с базой данных books (многотабличная).
</p>

<p>
Пример1. Показать кол-во издательств в базе данных.
</p>

<pre>

select count(id) as "Кол-во издательств" from press

</pre>

<img src="img\pict5.jpg"></img>

<p>
Пример2. Показать кол-во книг, кол-во страниц в которых больше 1000.
</p>

<pre>

select count(ALL books.name) as "кол-во" from books where pages>1000

</pre>

<img src="img\pict6.jpg"></img>

<p>
Пример3. Показать среднее арифметическое цен всех книг.
</p>

<pre>

select sum(price)/(count(id)) as "Среднее" from books

</pre>

<p>
Тот же самый результат можно получить, сделав такой запрос:
</p>

<pre>

select avg(price) as "Среднее" from books

</pre>

<img src="img\pict7.jpg"></img>

</Урок>